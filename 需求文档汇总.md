# 企业采购销售管理系统 - 需求文档

## 文档概述

本文档为采购销售管理系统的完整需求说明，包含项目概述、数据模型、业务流程、前端搭建步骤拆分等内容。系统采用 React + Vite + TypeScript 技术栈，后端使用 PocketBase（已完成搭建）。

---

## 第一部分：项目概述

### 1.1 项目背景

随着公司业务规模的不断扩大，采购和销售工作逐渐增多，传统的线下管理模式已无法满足日益增长的业务需求。为了提高工作效率、加强数据管理、实现信息共享，公司决定建设一套采购销售管理系统，将分散的线下工作整合到线上，实现关键业务数据的集中管理和实时监控。

### 1.2 项目目标

- 实现采购和销售业务流程的数字化管理
- 建立统一的数据存储平台，确保数据的安全性和完整性
- 提供实时的业务数据查询和统计分析功能
- 加强销售与采购部门之间的协作与信息共享
- 实现采购与销售合同的自动关联
- 为管理层提供决策支持数据

### 1.3 项目范围

| 模块类别 | 功能模块 | 说明 |
|---------|---------|------|
| **基础管理** | 用户认证与权限管理 | 登录、角色权限控制 |
| | 客户信息管理 | 销售客户档案管理 |
| | 供应商信息管理 | 采购供应商档案管理 |
| **销售管理** | 销售合同管理 | 合同创建、分批次执行 |
| | 销售发货管理 | 发货批次、物流跟踪 |
| | 销售发票管理 | 开票申请、发票记录 |
| | 销售收款管理 | 回款登记、收款跟踪 |
| | 销售进度跟踪 | 发货/收款/开票进度 |
| **采购管理** | 采购合同管理 | 合同创建、关联销售 |
| | 采购到货管理 | 到货批次、物流跟踪 |
| | 采购发票管理 | 收票登记、发票记录 |
| | 采购付款管理 | 付款申请、付款跟踪 |
| | 采购进度跟踪 | 到货/收票/付款进度 |
| **通知管理** | 消息通知 | 销售合同通知、系统通知 |
| **经理视图** | 合同总览 | 销售/采购合同全局查看 |
| | 关联对比 | 销售与采购进度对比 |
| | 进度跟踪 | 全局进度监控 |
| | 数据报表 | 销售/采购/财务报表 |
| | 历史记录 | 历史数据查询 |

### 1.4 业务角色

| 角色 | 角色标识 | 主要职责 |
|------|---------|----------|
| 销售职员 | sales | 客户维护、销售合同、发货、开票、回款 |
| 采购职员 | purchasing | 供应商维护、采购合同、到货、收票、付款 |
| 经理 | manager | 合同查看、进度跟踪、关联分析、数据报表 |

### 1.5 核心业务流程

```
销售流程：客户管理 → 签订销售合同 → 分批发货 → 开具发票 → 登记收款
                                    ↓
                                系统通知采购

采购流程：接收通知 → 查看销售合同 → 关联采购 → 分批到货 → 收票 → 付款

经理流程：合同总览 → 进度跟踪 → 关联对比 → 数据报表
```

### 1.6 技术选型

| 类别 | 技术栈 |
|------|--------|
| 前端框架 | React 18+ |
| 构建工具 | Vite |
| 开发语言 | TypeScript |
| UI组件库 | 待定（建议Ant Design或Material-UI） |
| 后端服务 | PocketBase |
| API接口 | RESTful API |
| 数据库 | SQLite（内置于PocketBase） |

### 1.7 API基础信息

- **Base URL**: `http://127.0.0.1:8090/api/`
- **认证方式**: Bearer Token（JWT）
- **数据格式**: JSON

---

## 第二部分：数据模型

### 2.1 数据集合总览

系统包含以下核心集合（表）：

| 集合名称 | 中文名 | 说明 |
|---------|--------|------|
| users | 用户表 | 系统用户，包含三种角色 |
| customers | 客户表 | 销售客户信息 |
| suppliers | 供应商表 | 采购供应商信息 |
| sales_contracts | 销售合同表 | 销售合同主表 |
| purchase_contracts | 采购合同表 | 采购合同主表 |
| sales_shipments | 销售发货批次表 | 销售发货记录 |
| purchase_arrivals | 采购到货批次表 | 采购到货记录 |
| sale_invoices | 销售发票表 | 销售开票记录 |
| purchase_invoices | 采购发票表 | 采购收票记录 |
| sale_receipts | 销售收款表 | 销售回款记录 |
| purchase_payments | 采购付款表 | 采购付款记录 |
| notifications | 通知表 | 系统通知 |

### 2.2 核心字段说明

#### 2.2.1 users（用户表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | UUID | 系统生成，唯一标识 |
| email | 邮箱 | 必填，唯一，登录账号 |
| name | 文本 | 真实姓名 |
| avatar | 文件 | 头像图片 |
| type | 文本 | 角色类型：sales / purchasing / manager |

#### 2.2.2 customers（客户表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | 文本 | 是 | 客户名称 |
| contact | 文本 | 否 | 联系人姓名 |
| phone | 文本 | 否 | 联系电话 |
| email | 文本 | 否 | 电子邮箱 |
| address | 文本 | 否 | 地址 |
| industry | 文本 | 否 | 所在行业 |
| region | 文本 | 否 | 所属地区 |
| bank_name | 文本 | 否 | 开户银行 |
| bank_account | 文本 | 否 | 银行账号 |
| remark | 文本 | 否 | 备注信息 |
| creator | 关系 -> users | 是 | 创建人 |

#### 2.2.3 suppliers（供应商表）

字段结构同 customers 表。

#### 2.2.4 sales_contracts（销售合同表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| no | 文本 | 是 | 合同编号（自动生成，格式：HT-YYYYMMDD-XXX） |
| product_name | 文本 | 是 | 产品名称/品名 |
| customer | 关系 -> customers | 是 | 关联的客户 |
| total_amount | 数字 | 是 | 合同总金额 |
| unit_price | 数字 | 是 | 产品单价 |
| total_quantity | 数字 | 是 | 合同总数量 |
| executed_quantity | 数字 | 是 | 已执行数量（自动计算） |
| execution_percent | 数字 | 是 | 执行百分比（自动计算） |
| receipted_amount | 数字 | 是 | 已收款金额（自动计算） |
| receipt_percent | 数字 | 是 | 收款百分比（自动计算） |
| debt_amount | 数字 | 是 | 欠款金额（自动计算） |
| debt_percent | 数字 | 是 | 欠款百分比（自动计算） |
| invoiced_amount | 数字 | 是 | 已开发票金额（自动计算） |
| invoice_percent | 数字 | 是 | 开票百分比（自动计算） |
| uninvoiced_amount | 数字 | 是 | 未开票金额（自动计算） |
| uninvoiced_percent | 数字 | 是 | 未开票百分比（自动计算） |
| sign_date | 日期 | 是 | 合同签订日期 |
| status | 选择 | 是 | 合同状态：executing / completed / cancelled |
| remark | 文本 | 否 | 备注 |
| attachments | 文件 | 否 | 合同附件 |
| creator | 关系 -> users | 是 | 创建人 |

#### 2.2.5 purchase_contracts（采购合同表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| no | 文本 | 是 | 合同编号（自动生成，格式：CG-YYYYMMDD-XXX） |
| product_name | 文本 | 是 | 产品名称/品名 |
| supplier | 关系 -> suppliers | 是 | 关联的供应商 |
| sales_contract | 关系 -> sales_contracts | 是 | 关联的销售合同（必填） |
| total_amount | 数字 | 是 | 合同总金额 |
| unit_price | 数字 | 是 | 产品单价 |
| total_quantity | 数字 | 是 | 合同总数量 |
| executed_quantity | 数字 | 是 | 已执行数量（自动计算） |
| execution_percent | 数字 | 是 | 执行百分比（自动计算） |
| invoiced_amount | 数字 | 是 | 已收发票金额（自动计算） |
| invoiced_percent | 数字 | 是 | 收票百分比（自动计算） |
| uninvoiced_amount | 数字 | 是 | 未收发票金额（自动计算） |
| uninvoiced_percent | 数字 | 是 | 未收票百分比（自动计算） |
| paid_amount | 数字 | 是 | 已付款金额（自动计算） |
| paid_percent | 数字 | 是 | 付款百分比（自动计算） |
| unpaid_amount | 数字 | 是 | 未付款金额（自动计算） |
| unpaid_percent | 数字 | 是 | 未付款百分比（自动计算） |
| sign_date | 日期 | 是 | 合同签订日期 |
| status | 选择 | 是 | 合同状态 |
| remark | 文本 | 否 | 备注 |
| attachments | 文件 | 否 | 合同附件 |
| creator | 关系 -> users | 是 | 创建人 |

#### 2.2.6 sales_shipments（销售发货批次表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| product_name | 文本 | 是 | 产品名称 |
| sales_contract | 关系 -> sales_contracts | 是 | 关联的销售合同 |
| tracking_contract_no | 文本 | 是 | 运输合同号 |
| date | 日期 | 是 | 发货日期 |
| quantity | 数字 | 是 | 发货数量 |
| logistics_company | 文本 | 是 | 物流公司名称 |
| shipment_address | 文本 | 是 | 发货地址 |
| delivery_address | 文本 | 是 | 收货地址 |
| freight | 数字 | 是 | 运费金额 |
| freight_status | 选择 | 是 | 运费状态：paid / unpaid |
| freight_date | 日期 | 否 | 运费付款时间 |
| invoice_status | 选择 | 是 | 发票状态：issued / unissued |
| remark | 文本 | 否 | 备注 |
| attachments | 文件 | 否 | 物流单据附件 |
| creator | 关系 -> users | 是 | 创建人 |

#### 2.2.7 purchase_arrivals（采购到货批次表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| product_name | 文本 | 是 | 产品名称 |
| purchase_contract | 关系 -> purchase_contracts | 是 | 关联的采购合同 |
| tracking_contract_no | 文本 | 是 | 运输合同号 |
| plan_date | 日期 | 是 | 计划到货日期 |
| actual_date | 日期 | 否 | 实际到货日期 |
| quantity | 数字 | 是 | 到货数量 |
| logistics_company | 文本 | 是 | 物流公司名称 |
| shipment_address | 文本 | 是 | 发货地址 |
| delivery_address | 文本 | 是 | 收货地址 |
| freight | 数字 | 是 | 运费金额 |
| freight_status | 选择 | 是 | 运费状态 |
| freight_date | 日期 | 否 | 运费付款时间 |
| invoice_status | 选择 | 是 | 发票状态 |
| recipient | 文本 | 否 | 收货人 |
| recipient_phone | 文本 | 否 | 收货人电话 |
| status | 选择 | 是 | 到货状态：pending / arrived / stocked |
| remark | 文本 | 否 | 备注 |
| attachments | 文件 | 否 | 物流单据附件 |
| creator | 关系 -> users | 是 | 创建人 |

#### 2.2.8 sale_invoices（销售发票表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| no | 文本 | 是 | 发票号码 |
| product_name | 文本 | 是 | 产品名称 |
| sales_contract | 关系 -> sales_contracts | 是 | 关联的销售合同 |
| invoice_type | 文本 | 是 | 发票类型 |
| product_amount | 数字 | 是 | 发票对应的产品数量 |
| amount | 数字 | 是 | 发票金额 |
| issue_date | 日期 | 是 | 开票日期 |
| remark | 文本 | 否 | 备注 |
| attachments | 文件 | 否 | 发票附件 |
| creator | 关系 -> users | 是 | 创建人 |

#### 2.2.9 purchase_invoices（采购发票表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| no | 文本 | 是 | 发票号码 |
| code | 文本 | 否 | 发票代码 |
| product_name | 文本 | 是 | 产品名称 |
| purchase_contract | 关系 -> purchase_contracts | 是 | 关联的采购合同 |
| invoice_type | 文本 | 是 | 发票类型 |
| supplier | 文本 | 否 | 开票单位 |
| product_amount | 数字 | 是 | 发票对应的产品数量 |
| amount | 数字 | 是 | 发票金额 |
| tax_rate | 数字 | 否 | 税率 |
| tax_amount | 数字 | 否 | 税额 |
| receive_date | 日期 | 是 | 收票日期 |
| remark | 文本 | 否 | 备注 |
| attachments | 文件 | 否 | 发票附件 |
| creator | 关系 -> users | 是 | 创建人 |

#### 2.2.10 sale_receipts（销售收款表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| product_name | 文本 | 是 | 产品名称 |
| sales_contract | 关系 -> sales_contracts | 是 | 关联的销售合同 |
| amount | 数字 | 是 | 收款金额 |
| product_amount | 数字 | 是 | 收款对应的产品数量 |
| receipt_date | 日期 | 是 | 收款日期 |
| method | 文本 | 否 | 收款方式 |
| account | 文本 | 否 | 收款账户 |
| remark | 文本 | 否 | 备注 |
| attachments | 文件 | 否 | 收款凭证附件 |
| creator | 关系 -> users | 是 | 创建人 |

#### 2.2.11 purchase_payments（采购付款表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| no | 文本 | 是 | 付款单号（自动生成） |
| product_name | 文本 | 是 | 产品名称 |
| purchase_contract | 关系 -> purchase_contracts | 是 | 关联的采购合同 |
| product_amount | 数字 | 是 | 付款对应的产品数量 |
| amount | 数字 | 是 | 付款金额 |
| pay_date | 日期 | 是 | 付款日期 |
| method | 文本 | 否 | 付款方式 |
| account | 文本 | 否 | 付款账户 |
| recipient | 文本 | 否 | 收款单位 |
| recipient_bank | 文本 | 否 | 收款银行 |
| recipient_account | 文本 | 否 | 收款账号 |
| remark | 文本 | 否 | 备注 |
| attachments | 文件 | 否 | 付款凭证附件 |
| creator | 关系 -> users | 是 | 创建人 |

#### 2.2.12 notifications（通知表）

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| type | 文本 | 是 | 通知类型 |
| sales_contract | 关系 -> sales_contracts | 是 | 关联的销售合同 |
| title | 文本 | 是 | 通知标题 |
| message | 文本 | 是 | 通知内容 |
| is_read | 布尔 | 是 | 是否已读（默认false） |
| recipient | 关系 -> users | 是 | 接收人 |

### 2.3 数据关联关系图

```
客户 ──► 销售合同 ──┬──► 销售发货批次
                    ├──► 销售发票
                    ├──► 销售收款
                    └──► 关联 ──► 采购合同 ──► 供应商
                                       ├──► 采购到货批次
                                       ├──► 采购发票
                                       └──► 采购付款
```

### 2.4 自动计算规则

#### 2.4.1 销售合同计算

| 字段 | 计算方式 |
|------|----------|
| execution_percent | (executed_quantity / total_quantity) × 100% |
| receipt_percent | (receipted_amount / total_amount) × 100% |
| debt_amount | total_amount - receipted_amount |
| debt_percent | (debt_amount / total_amount) × 100% |
| invoice_percent | (invoiced_amount / total_amount) × 100% |
| uninvoiced_amount | total_amount - invoiced_amount |
| uninvoiced_percent | (uninvoiced_amount / total_amount) × 100% |

#### 2.4.2 采购合同计算

| 字段 | 计算方式 |
|------|----------|
| execution_percent | (executed_quantity / total_quantity) × 100% |
| invoiced_percent | (invoiced_amount / total_amount) × 100% |
| uninvoiced_amount | total_amount - invoiced_amount |
| uninvoiced_percent | (uninvoiced_amount / total_amount) × 100% |
| paid_percent | (paid_amount / total_amount) × 100% |
| unpaid_amount | total_amount - paid_amount |
| unpaid_percent | (unpaid_amount / total_amount) × 100% |

### 2.5 权限矩阵

| 功能/角色 | 销售 (sales) | 采购 (purchasing) | 经理 (manager) |
|----------|-------------|------------------|----------------|
| customers 表 | CRUD 本人创建的 | 仅读取 | 仅读取 |
| suppliers 表 | 仅读取 | CRUD 本人创建的 | 仅读取 |
| sales_contracts | CRUD 本人创建的 | 仅读取 | 仅读取 |
| purchase_contracts | 仅读取 | CRUD 本人创建的 | 仅读取 |
| sales_shipments | CRUD 本人创建的 | 仅读取 | 可更新 |
| purchase_arrivals | 仅读取 | CRUD 本人创建的 | 可更新 |
| sale_invoices | CRUD 本人创建的 | 仅读取 | 可更新 |
| purchase_invoices | 仅读取 | CRUD 本人创建的 | 可更新 |
| sale_receipts | CRUD 本人创建的 | 仅读取 | 可更新 |
| purchase_payments | 仅读取 | CRUD 本人创建的 | 可更新 |
| notifications | 读取本人 | 读取本人 | 读取本人 |

---

## 第三部分：前端搭建功能拆分

以下为前端开发的完整步骤拆分，每个步骤对应一个功能分支，可独立开发和测试。

### 步骤清单

| 步骤 | 分支名称 | 功能描述 | 预计工作量 |
|------|---------|----------|-----------|
| 01 | feature/init-project | 项目初始化 | 0.5天 |
| 02 | feature/pocketbase-sdk | PocketBase SDK集成 | 0.5天 |
| 03 | feature/router-auth | 路由与认证基础 | 1天 |
| 04 | feature/login-page | 登录页面 | 1天 |
| 05 | feature-layout | 系统布局框架 | 1天 |
| 06 | feature-sales-customer | 销售-客户管理 | 1.5天 |
| 07 | feature-sales-contract | 销售-合同管理 | 2天 |
| 08 | feature-sales-shipment | 销售-发货管理 | 1.5天 |
| 09 | feature-sales-invoice | 销售-发票管理 | 1天 |
| 10 | feature-sales-receipt | 销售-收款管理 | 1天 |
| 11 | feature-sales-progress | 销售-进度跟踪 | 1天 |
| 12 | feature-purchase-supplier | 采购-供应商管理 | 1.5天 |
| 13 | feature-purchase-contract | 采购-合同管理 | 2天 |
| 14 | feature-purchase-arrival | 采购-到货管理 | 1.5天 |
| 15 | feature-purchase-invoice | 采购-发票管理 | 1天 |
| 16 | feature-purchase-payment | 采购-付款管理 | 1天 |
| 17 | feature-purchase-progress | 采购-进度跟踪 | 1天 |
| 18 | feature-manager-dashboard | 经理-总览仪表盘 | 1.5天 |
| 19 | feature-manager-progress | 经理-进度跟踪 | 1天 |
| 20 | feature-manager-comparison | 经理-关联对比 | 1天 |
| 21 | feature-manager-report | 经理-数据报表 | 1.5天 |
| 22 | feature-manager-history | 经理-历史记录 | 1天 |
| 23 | feature-notification | 通知中心 | 0.5天 |
| 24 | feature-bugfix | Bug修复与优化 | 2天 |

---

### 步骤01：feature/init-project

**功能描述**：项目初始化

**具体任务**：

1. 使用 Vite 创建 React + TypeScript 项目
   ```bash
   npm create vite@latest procurement-sales-system -- --template react-ts
   cd procurement-sales-system
   npm install
   ```

2. 安装必要的依赖
   - UI组件库（Ant Design 或 MUI）
   - 路由库（react-router-dom）
   - 状态管理（如需要）
   - HTTP请求库（axios）
   - 其他工具库

3. 配置项目基础结构
   ```
   src/
   ├── api/           # API请求
   ├── assets/        # 静态资源
   ├── components/   # 公共组件
   ├── layouts/      # 布局组件
   ├── pages/        # 页面组件
   ├── routes/       # 路由配置
   ├── stores/       # 状态管理
   ├── types/        # TypeScript类型
   ├── utils/        # 工具函数
   └── App.tsx
   ```

4. 配置 TypeScript 编译选项

5. 配置 Vite 开发服务器代理（解决跨域问题）

**验收标准**：

- 项目可以正常启动（npm run dev）
- 没有 TypeScript 编译错误
- 目录结构符合预期

---

### 步骤02：feature/pocketbase-sdk

**功能描述**：PocketBase SDK 集成

**具体任务**：

1. 安装 PocketBase SDK
   ```bash
   npm install pocketbase
   ```
2. 创建 PocketBase 客户端实例

3. 创建认证相关类型定义
   
4. 创建认证状态管理（如使用 Context 或 Zustand）
   - 用户登录状态
   - 用户信息存储
   - Token 持久化

**验收标准**：

- PocketBase 客户端可以正常连接
- 登录/登出功能可以正常工作

---

### 步骤03：feature/router-auth

**功能描述**：路由与认证基础

**具体任务**：

1. 配置 React Router
   
2. 创建认证 Context/Hook
   
3. 创建路由守卫组件

4. 配置各角色可访问的路由

**验收标准**：

- 未登录用户访问内部页面会自动跳转到登录页
- 登录后可以正常访问内部页面

---

### 步骤04：feature/login-page

**功能描述**：登录页面

**具体任务**：

1. 创建登录页面组件
   - 邮箱输入框
   - 密码输入框
   - 登录按钮
   - 错误提示

2. 实现登录逻辑
   
3. 实现退出登录功能
  
4. 添加登录状态持久化（页面刷新后保持登录状态）

**验收标准**：

- 可以使用正确的账号密码登录
- 登录失败显示错误提示
- 登录成功后跳转到首页
- 刷新页面保持登录状态

---

### 步骤05：feature-layout

**功能描述**：系统布局框架

**具体任务**：

1. 创建主布局组件（MainLayout）
   - 顶部导航栏（Logo、用户信息、退出按钮）
   - 左侧侧边栏（根据角色显示不同菜单）
   - 主内容区域

2. 根据用户角色动态生成菜单
   - 销售角色：客户管理、销售合同、发货、发票、收款、进度跟踪
   - 采购角色：供应商管理、采购合同、到货、发票、付款、进度跟踪
   - 经理角色：总览、进度跟踪、关联对比、数据报表、历史记录

3. 布局样式调整

**验收标准**：

- 布局正常显示
- 菜单根据角色正确显示
- 点击菜单可以切换内容区域

---

### 步骤06：feature-sales-customer

**功能描述**：销售-客户管理

**具体任务**：

1. 客户列表页面
   - 表格展示客户信息（名称、联系人、电话、邮箱、地区）
   - 支持搜索（按名称、地区）
   - 分页功能

2. 客户详情页面
   - 展示客户详细信息
   - 关联的销售合同列表

3. 客户新增/编辑弹窗
   - 表单字段：名称、联系人、电话、邮箱、地址、行业、地区、开户银行、账号、备注
   - 表单验证

4. 删除客户功能

5. API 调用
 

**验收标准**：

- 可以查看客户列表
- 可以新增客户
- 可以编辑客户信息
- 可以删除客户
- 可以查看客户详情

---

### 步骤07：feature-sales-contract

**功能描述**：销售-合同管理

**具体任务**：

1. 销售合同列表页面
   - 表格展示合同信息（编号、品名、客户、签订日期、总金额、执行进度、收款进度、开票进度、状态）
   - 支持搜索和筛选
   - 分页功能

2. 销售合同详情页面
   - 展示合同基本信息
   - 关联的客户信息
   - 发货批次列表
   - 发票列表
   - 收款记录列表
   - 进度条展示

3. 销售合同新增/编辑弹窗
   - 选择客户（下拉选择）
   - 输入品名、单价、数量
   - 自动计算总金额
   - 选择签订日期
   - 上传合同附件（PDF、图片等）
   - 添加备注

4. 删除合同功能

5. 合同附件查看和下载功能

6. 合同状态自动更新逻辑（后端自动处理）

**验收标准**：

- 可以查看销售合同列表
- 可以新增销售合同
- 可以编辑合同信息
- 可以删除合同
- 可以查看合同详情及关联数据
- 合同创建后自动通知采购

---

### 步骤08：feature-sales-shipment

**功能描述**：销售-发货管理

**具体任务**：

1. 销售发货列表页面
   - 表格展示发货信息（运输合同号、品名、合同编号、物流公司、发货日期、数量、运费状态、发票状态）
   - 支持搜索和筛选
   - 分页功能

2. 发货详情页面
   - 展示发货详细信息
   - 关联的合同信息

3. 发货新增/编辑弹窗
   - 选择关联的销售合同（下拉选择）
   - 输入运输合同号
   - 选择发货日期
   - 输入发货数量
   - 输入物流公司
   - 输入发货地址、收货地址
   - 输入运费金额
   - 选择运费状态、发票状态
   - 上传物流单据附件（运单、签收单等）
   - 添加备注

4. 删除发货记录功能

5. 发货附件查看和下载功能

6. 发货后自动更新合同执行进度（后端自动处理）

**验收标准**：

- 可以查看发货列表
- 可以新增发货记录
- 可以编辑发货信息
- 可以删除发货记录
- 发货后合同执行进度自动更新

---

### 步骤09：feature-sales-invoice

**功能描述**：销售-发票管理

**具体任务**：

1. 销售发票列表页面
   - 表格展示发票信息（发票号码、品名、合同编号、开票日期、发票金额）
   - 支持搜索和筛选
   - 分页功能

2. 发票详情页面
   - 展示发票详细信息

3. 发票新增/编辑弹窗
   - 输入发票号码
   - 选择关联的销售合同
   - 选择发票类型
   - 输入产品数量
   - 输入发票金额
   - 选择开票日期
   - 上传发票附件（发票图片、PDF等）
   - 添加备注

4. 删除发票功能

5. 发票附件查看和下载功能

6. 开票后自动更新合同开票进度（后端自动处理）

**验收标准**：

- 可以查看发票列表
- 可以新增发票记录
- 可以编辑发票信息
- 可以删除发票记录
- 开票后合同开票进度自动更新

---

### 步骤10：feature-sales-receipt

**功能描述**：销售-收款管理

**具体任务**：

1. 销售收款列表页面
   - 表格展示收款信息（合同编号、品名、收款日期、收款金额、产品数量、收款方式）
   - 支持搜索和筛选
   - 分页功能

2. 收款详情页面
   - 展示收款详细信息

3. 收款新增/编辑弹窗
   - 选择关联的销售合同
   - 输入收款金额
   - 输入产品数量
   - 选择收款日期
   - 选择收款方式
   - 输入收款账户
   - 上传收款凭证附件（银行回单、转账记录等）
   - 添加备注

4. 删除收款记录功能

5. 收款凭证查看和下载功能

6. 收款后自动更新合同收款进度和欠款（后端自动处理）

**验收标准**：

- 可以查看收款列表
- 可以新增收款记录
- 可以编辑收款信息
- 可以删除收款记录
- 收款后合同收款进度和欠款金额自动更新

---

### 步骤11：feature-sales-progress

**功能描述**：销售-进度跟踪

**具体任务**：

1. 销售进度跟踪页面
   - 展示所有销售合同的进度情况
   - 发货进度条
   - 收款进度条
   - 开票进度条

2. 进度可视化
   - 百分比进度条
   - 数值展示（已执行/总数量、已收款/总金额、已开票/总金额）

3. 进度异常提醒
   - 显示进度滞后或异常的合同

**验收标准**：

- 可以查看所有销售合同的进度
- 进度百分比正确显示
- 可以快速识别进度滞后的合同

---

### 步骤12：feature-purchase-supplier

**功能描述**：采购-供应商管理

**具体任务**：

1. 供应商列表页面
   - 表格展示供应商信息
   - 支持搜索和筛选

2. 供应商详情页面
   - 展示供应商详细信息
   - 关联的采购合同列表

3. 供应商新增/编辑弹窗
   - 表单字段类似客户管理

4. 删除供应商功能

**验收标准**：

- 可以查看供应商列表
- 可以新增供应商
- 可以编辑供应商信息
- 可以删除供应商
- 可以查看供应商详情

---

### 步骤13：feature-purchase-contract

**功能描述**：采购-合同管理

**具体任务**：

1. 采购合同列表页面
   - 表格展示采购合同信息
   - 支持搜索和筛选

2. 采购合同详情页面
   - 展示合同基本信息
   - 关联的供应商信息
   - 关联的销售合同信息（可点击查看）
   - 到货批次列表
   - 发票列表
   - 付款记录列表
   - 进度条展示

3. 采购合同新增/编辑弹窗
   - 选择供应商
   - 选择关联的销售合同（必选）
   - 输入品名、单价、数量
   - 自动计算总金额
   - 选择签订日期
   - 上传合同附件（PDF、图片等）
   - 添加备注

4. 删除合同功能

5. 合同附件查看和下载功能

**验收标准**：

- 可以查看采购合同列表
- 可以新增采购合同（必须关联销售合同）
- 可以编辑合同信息
- 可以删除合同
- 可以查看合同详情及关联数据

---

### 步骤14：feature-purchase-arrival

**功能描述**：采购-到货管理

**具体任务**：

1. 采购到货列表页面
   - 表格展示到货信息
   - 支持搜索和筛选

2. 到货详情页面
   - 展示到货详细信息
   - 关联的合同信息

3. 到货新增/编辑弹窗
   - 选择关联的采购合同
   - 输入运输合同号
   - 选择计划到货日期
   - 输入到货数量
   - 输入物流公司
   - 输入发货地址、收货地址
   - 输入运费金额
   - 选择运费状态、发票状态
   - 选择到货状态（待到货/已到货/已入库）
   - 上传物流单据附件（运单、签收单、入库单等）
   - 添加备注

4. 删除到货记录功能

5. 到货附件查看和下载功能

6. 到货后自动更新合同执行进度（后端自动处理）

**验收标准**：

- 可以查看到货列表
- 可以新增到货记录
- 可以编辑到货信息
- 可以删除到货记录
- 到货后合同执行进度自动更新

---

### 步骤15：feature-purchase-invoice

**功能描述**：采购-发票管理

**具体任务**：

1. 采购发票列表页面
   - 表格展示收票信息

2. 发票详情页面
   - 展示发票详细信息

3. 发票新增/编辑弹窗
   - 输入发票号码、发票代码
   - 选择关联的采购合同
   - 选择发票类型
   - 输入开票单位（供应商）
   - 输入产品数量
   - 输入发票金额
   - 输入税率、税额
   - 选择收票日期
   - 上传发票附件（发票图片、PDF、认证凭证等）
   - 添加备注

4. 删除发票功能

5. 发票附件查看和下载功能

6. 收票后自动更新合同收票进度（后端自动处理）

**验收标准**：

- 可以查看收票列表
- 可以新增收票记录
- 可以编辑收票信息
- 可以删除收票记录
- 收票后合同收票进度自动更新

---

### 步骤16：feature-purchase-payment

**功能描述**：采购-付款管理

**具体任务**：

1. 采购付款列表页面
   - 表格展示付款信息

2. 付款详情页面
   - 展示付款详细信息

3. 付款新增/编辑弹窗
   - 选择关联的采购合同
   - 输入付款金额
   - 输入产品数量
   - 选择付款日期
   - 选择付款方式
   - 输入付款账户
   - 输入收款单位、银行、账号
   - 上传付款凭证附件（银行回单、转账记录、审批单等）
   - 添加备注

4. 删除付款记录功能

5. 付款凭证查看和下载功能

6. 付款后自动更新合同付款进度（后端自动处理）

**验收标准**：

- 可以查看付款列表
- 可以新增付款记录
- 可以编辑付款信息
- 可以删除付款记录
- 付款后合同付款进度自动更新

---

### 步骤17：feature-purchase-progress

**功能描述**：采购-进度跟踪

**具体任务**：

1. 采购进度跟踪页面
   - 展示所有采购合同的进度情况
   - 到货进度条
   - 收票进度条
   - 付款进度条

2. 进度可视化

3. 进度异常提醒

**验收标准**：

- 可以查看所有采购合同的进度
- 进度百分比正确显示
- 可以快速识别进度滞后的合同

---

### 步骤18：feature-manager-dashboard

**功能描述**：经理-总览仪表盘

**具体任务**：

1. 仪表盘首页
   - 销售合同总数、金额汇总
   - 采购合同总数、金额汇总
   - 正在进行中的合同数量
   - 待处理事项提醒

2. 快速链接
   - 最近更新的合同
   - 快速跳转到详细页面

**验收标准**：

- 仪表盘正确显示各类统计数字
- 可以快速了解整体业务状况

---

### 步骤19：feature-manager-progress

**功能描述**：经理-进度跟踪

**具体任务**：

1. 全局进度跟踪页面
   - 销售合同进度（发货、收款、开票）
   - 采购合同进度（到货、收票、付款）

2. 进度筛选和搜索

3. 导出功能（如需要）

**验收标准**：

- 可以查看所有合同的进度
- 可以筛选特定合同

---

### 步骤20：feature-manager-comparison

**功能描述**：经理-关联对比

**具体任务**：

1. 销售与采购关联对比页面
   - 选择一个销售合同
   - 显示关联的采购合同信息
   - 进度对比（发货vs到货、收款vs付款、开票vs收票）
   - 利润分析（销售金额 - 采购金额）

2. 可视化对比

**验收标准**：

- 可以选择销售合同查看关联的采购合同
- 进度对比数据正确显示
- 利润计算正确

---

### 步骤21：feature-manager-report

**功能描述**：经理-数据报表

**具体任务**：

1. 销售报表
   - 销售业绩统计
   - 客户分析
   - 合同状态分布

2. 采购报表
   - 采购成本统计
   - 供应商分析
   - 合同状态分布

3. 财务报表
   - 应收账款统计
   - 应付账款统计
   - 利润统计

4. 报表导出功能（可选）

**验收标准**：

- 各类报表数据正确
- 可以按时间筛选

---

### 步骤22：feature-manager-history

**功能描述**：经理-历史记录

**具体任务**：

1. 历史合同列表
   - 已完成的合同
   - 已取消的合同

2. 历史发货记录

3. 历史发票记录

4. 历史付款记录

**验收标准**：

- 可以查看历史数据
- 可以按时间筛选

---

### 步骤23：feature-notification

**功能描述**：通知中心

**具体任务**：

1. 通知列表
   - 展示当前用户收到的通知
   - 显示通知类型、标题、时间、已读/未读状态

2. 通知详情
   - 点击通知查看详情

3. 标记已读功能

4. 通知类型
   - 销售合同创建通知（通知采购）
   - 合同状态变更通知

**验收标准**：

- 可以查看通知列表
- 可以标记通知为已读
- 销售合同创建后采购收到通知

---

### 步骤24：feature-bugfix

**功能描述**：Bug修复与优化

**具体任务**：

1. 收集并修复测试中发现的问题

2. 性能优化

3. 用户体验优化

4. 边界情况处理

**验收标准**：

- 所有测试用例通过
- 系统稳定运行

---

## 第四部分：网站页面样式设计

### 4.1 设计风格

**设计理念**：极简现代、专业商务风，无冗余装饰，强调信息层级和操作效率。

### 4.2 色彩体系

| 用途 | 颜色 | 色值 |
|------|------|------|
| 主背景 | 纯白色 | #FFFFFF |
| 文本（主要） | 深灰/黑色 | #333333 |
| 文本（次要） | 浅灰 | #999999 |
| 选中/高亮 | 浅灰色背景 | #F5F5F5 |
| 按钮（主按钮） | 深色（近乎黑色）背景 | #1A1A1A |
| 按钮文字 | 白色 | #FFFFFF |

**字体**：无衬线字体（如 Inter、PingFang SC、Helvetica），清晰易读。

### 4.3 布局结构（响应式）

#### 桌面端（≥1200px）

- 左侧固定侧边栏，宽度约 280px，白色背景
- 右侧主内容区，占据剩余宽度，顶部显示页面标题和用户信息

#### 移动端（≤767px）

- 顶部导航栏：左侧汉堡菜单图标（三条横线），右侧显示"Admin User"
- 侧边栏：默认隐藏，点击汉堡菜单后从左侧滑出，宽度为屏幕的 70%-80%，右上角有关闭"×"按钮
- 主内容区：全屏显示，无侧边栏占用

### 4.4 导航菜单样式

**菜单项**

**图标**：每个菜单项前有线性图标，图标与文字间距约 12px

**选中状态**：当前页面菜单项背景为浅灰色 (#F5F5F5)，文字加粗或颜色加深

**间距**：菜单项上下 padding 约 16px，左右 padding 约 24px

### 4.5 核心组件样式

#### 数据卡片

- 外观：白色背景，圆角 12px，轻微阴影 `box-shadow: 0 2px 8px rgba(0,0,0,0.08)`
- 内边距：上下 24px，左右 20px
- 内容布局：
  - 标题：16px，深灰
  - 数字：32px，加粗，黑色
- 布局：桌面端 2 列网格，移动端单列堆叠

#### 按钮

- 主按钮：深色背景，圆角 8px，内边距 12px 24px，文字 16px，白色
- 次要按钮：浅灰边框，圆角 16px，内边距 6px 12px，文字 14px



## 第五部分：开发注意事项

### 4.1 后端依赖

本前端项目依赖 PocketBase 后端服务，后端已配置以下内容：

1. **集合创建**：按照数据模型部分创建所有集合
2. **API规则**：配置各集合的 API 访问规则
3. **后端钩子**：配置自动计算逻辑（合同进度更新、通知发送等）

### 4.2 开发环境

- 前端开发服务器：`http://localhost:5173`（Vite 默认）
- 后端服务器：`http://127.0.0.1:8090`

### 4.3 测试账号

测试已创建以下测试账号：

| 角色 | 邮箱 | 密码 | 类型 |
|------|------|------|------|
| 销售职员 | sales@test.com | 12345678 | sales |
| 采购职员 | purchase@test.com | 12345678 | purchasing |
| 经理 | manager@test.com | 12345678 | manager |

---

## 附录：文件变更记录

| 日期 | 版本 | 变更内容 | 作者 |
|------|------|----------|------|
| 2024-02-15 | 1.0 | 初始版本 | - |
| 2026-02-17 | 1.1 | 新增网站页面样式设计部分 | - |
